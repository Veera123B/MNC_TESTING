CREATE DATABASE MNC_TESTING_FINAL;
USE MNC_TESTING_FINAL;

SELECT * FROM DBO.MNC_Large_Sales_Data_50000

UPDATE MNC_Large_Sales_Data_50000 SET EMAIL = 'user3@example.com' WHERE ORDERID = 3 


---------------------CHECK THE WITHSPACES ROW'S ----------------------------------
SELECT EMAIL , ORDERID FROM MNC_Large_Sales_Data_50000 WHERE EMAIL <> RTRIM(EMAIL) ------TRIM IS USED FOR THE TO REMOVE THE SPACE

SELECT TRIM (REPLACE(EMAIL , ' ' , '')) AS REMOVED_SPACES FROM MNC_Large_Sales_Data_50000 ---- THIS REPLACED IS USED FOR WHEN THE SPACE IS MIDDLE THAT TIME EMPTY SPAVE TO NO SPAVE
SELECT LTRIM(REPLACE(EMAIL , ' ' , '')) AS REMOCE_LEFT_SPACES FROM MNC_Large_Sales_Data_50000
SELECT RTRIM(REPLACE(EMAIL , ' ' , '')) AS REMOVE_RIGHT_SPACES FROM MNC_Large_Sales_Data_50000

--------------CHECK THE UPPER AND LOWER CASE----------

SELECT UPPER(TRIM(REPLACE (CUSTOMERNAME , '_' , '-'))) FROM MNC_Large_Sales_Data_50000;
SELECT LOWER(TRIM(REPLACE (CUSTOMERNAME , '_' , '-')))  FROM MNC_Large_Sales_Data_50000

SELECT CAST(CUSTOMERNAME AS varchar) FROM MNC_Large_Sales_Data_50000

SELECT CAST(TRY_CAST(CUSTOMERID AS decimal(18,2)) AS varchar) FROM MNC_Large_Sales_Data_50000

SELECT CAST(TRY_CAST(UNITPRICE AS INT) AS varchar) FROM MNC_Large_Sales_Data_50000


SELECT ORDERDATE,TRY_CAST(CONVERT(varchar(10), ORDERDATE, 103) AS varchar) AS NEW_DATEFORMAT FROM MNC_Large_Sales_Data_50000

SELECT UPPER(TRIM(REPLACE(CUSTOMERCODE , 'CUST' , ''))) FROM MNC_Large_Sales_Data_50000

SELECT CAST(TRY_CAST(UNITPRICE AS decimal (18,2)) AS decimal (18,2))  FROM MNC_Large_Sales_Data_50000

SELECT UNITPRICE,
CASE 
WHEN UNITPRICE IS NULL OR UNITPRICE = '' THEN 'WRONGVALUE'
WHEN CAST(TRY_CAST(UNITPRICE AS DECIMAL(18,2)) AS DECIMAL (18,2)) IS NULL THEN 'NOT NUMERIC'
WHEN UNITPRICE < 0 THEN 'NEGATIVE'
ELSE CAST(TRY_CAST(UNITPRICE AS DECIMAL(18,2)) AS DECIMAL (18,2)) 
END
FROM MNC_Large_Sales_Data_50000



SELECT AMOUNT,
CASE 
WHEN AMOUNT IS NULL OR AMOUNT = '' THEN 'WRONGVALUE'
WHEN CAST(TRY_CAST(AMOUNT AS DECIMAL(12,3)) AS decimal(12,3)) IS NULL THEN 'NOTNUMERIC'
WHEN AMOUNT <0 THEN 'NEGATIVE VALUE'
ELSE CAST(TRY_CAST(AMOUNT AS DECIMAL(12,3)) AS decimal(12,3))
END
FROM MNC_Large_Sales_Data_50000


SELECT * FROM MNC_Large_Sales_Data_50000

SELECT COUNT(*), STATUS FROM MNC_Large_Sales_Data_50000 GROUP BY STATUS HAVING COUNT(*) >1

SELECT STATUS ,
CASE
WHEN STATUS = 'A' THEN 'ACCESS'
WHEN STATUS = 'C' THEN 'COMPLETED'
WHEN STATUS = 'I' THEN 'INITIAL'
ELSE 'OK'
END
FROM MNC_Large_Sales_Data_50000


-------------------INSERT QUERY TO FINAL QUAERY-----------------------------------
IF OBJECT_ID ('FINAL_SALES_TABLE', 'U') IS NOT NULL 
DROP TABLE FINAL_SALES_TABLE;
CREATE TABLE FINAL_SALES_TABLE
(ORDERID INT ,
ORDERDATE DATE,
CUSTOMERID INT,
CUSTOMERCODE INT ,
QUANTITY INT,
UNITPRICE DECIMAL(12,3),
AMOUNT DECIMAL(12,3),
STATUS CHAR(50),
EMAIL NVARCHAR(50))


INSERT INTO FINAL_SALES_TABLE
(ORDERID,ORDERDATE,CUSTOMERID,CUSTOMERCODE,QUANTITY,UNITPRICE,AMOUNT,STATUS,EMAIL)
SELECT * FROM 
(
SELECT 
CASE
WHEN TRY_CAST(ORDERID AS INT) IS NULL THEN 'NULL'
WHEN TRY_CAST(ORDERID AS INT)IS NULL THEN 'NOT NUMERIC'
WHEN TRY_CAST(ORDERID AS INT) <0 THEN 'NEGATIVE VALUE'
WHEN TRY_CAST(ORDERID AS INT) > 500001 THEN 'VALUE IS HIGH'
ELSE TRY_CAST(ORDERID AS INT)
END AS NEW_ORDERID ,
CONVERT(DATE, ORDERDATE , 105) AS NEW_DATE,
TRIM (CAST(CustomerID AS varchar)) AS NEW_CUSTOMERID, 
TRIM(REPLACE(CUSTOMERCODE, 'CUST', '')) AS NEW_CUSTOMERCODE,
CASE 
WHEN Quantity IS NULL OR Quantity = '' THEN 'QUANTITYNULL'
WHEN TRY_CAST(QUANTITY AS int) IS NULL THEN 'NOT NUMERIC'
WHEN Quantity <0 THEN 'VALUE IS NEGATIVE'
WHEN TRY_CAST (QUANTITY AS INT)  > 10000 THEN 'VALUE IS HIGH'
WHEN QUANTITY LIKE '%.%' THEN 'EMPTY VALUE'
ELSE TRY_CAST(QUANTITY AS INT) 
END AS NEW_QUANTITY,
CASE 
WHEN UnitPrice IS NULL OR UnitPrice = '' THEN 'WRONGVALUE'
WHEN CAST(TRY_CAST(UnitPrice AS DECIMAL(12,2)) AS decimal(12,2)) IS NULL THEN 'NOTNUMERIC'
WHEN UnitPrice <0 THEN 'NEGATIVE VALUE'
ELSE CAST(TRY_CAST(UnitPrice AS DECIMAL(12,2)) AS decimal(12,2))
END AS NEW_UNITPRICE,
CASE 
WHEN AMOUNT IS NULL OR AMOUNT = '' THEN 'WRONGVALUE'
WHEN CAST(TRY_CAST(AMOUNT AS DECIMAL(12,3)) AS decimal(12,3)) IS NULL THEN 'NOTNUMERIC'
WHEN AMOUNT <0 THEN 'NEGATIVE VALUE'
ELSE CAST(TRY_CAST(AMOUNT AS DECIMAL(12,3)) AS decimal(12,3))
END AS NEW_AMOUNT,
CASE
WHEN STATUS = 'A' THEN 'ACCESS'
WHEN STATUS = 'C' THEN 'COMPLETED'
WHEN STATUS = 'I' THEN 'INITIAL'
ELSE 'OK'
END AS NEW_STATUS,
CASE 
WHEN EMAIL IS NULL OR LTRIM(RTRIM(Email)) = '' THEN 'EMPTY' 
WHEN Email LIKE '% %' THEN 'SPACE NOT ALLOWED'
WHEN LEN(EMAIL) > 25 THEN 'EMAIL LENGTH IS TOO HIGH'
WHEN Email LIKE '%[A-#Z$_+?>]%' THEN 'EMAIL NOT GOOD FORMAT'
ELSE 'VALID'
END AS VALID_EMAIL
FROM MNC_Large_Sales_Data_50000 
)AS NEW_QUERY
WHERE VALID_EMAIL = 'VALID';


SELECT * FROM MNC_Large_Sales_Data_50000

SELECT RIGHT(EMAIL, 6) from MNC_Large_Sales_Data_50000

SELECT LEFT (EMAIL, 7) FROM MNC_Large_Sales_Data_50000

SELECT SUBSTRING(EMAIL,2,9) FROM  MNC_Large_Sales_Data_50000

SELECT * FROM MNC_Large_Sales_Data_50000


completed









