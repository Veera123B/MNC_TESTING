CREATE TABLE FINAL_SALES_TABLE_DATETIME 
( NEW_DATEVALUE DATE,
NEW_FOMRAT_STAGE DATE,
NEW_FORMAT_STAGE DATE,
S120_FORMAT DATETIME2,
NEW_TIME TIME(7),
DATETIME2VALUE DATETIME2 )

INSERT INTO FINAL_SALES_TABLE_DATETIME( 
NEW_DATEVALUE,
NEW_FOMRAT_STAGE,
NEW_FORMAT_STAGE,
S120_FORMAT,
NEW_TIME,
DATETIME2VALUE)
SELECT 
	CASE
	WHEN DATEVALUE IS NULL OR LTRIM(RTRIM(DATEVALUE)) = '' THEN 'DATEFORMAT IS NOT GOOD'
	WHEN  TRY_CAST(DATEVALUE AS DATE) IS NULL THEN 'THIS IS NOT DATE FORMAT'
	WHEN  TRY_CAST(DATEVALUE AS DATE) > GETDATE() THEN 'WORNG'
	WHEN  TRY_CAST(DATEVALUE AS DATE) < DATEADD (YEAR,-5,GETDATE()) THEN 'OLDDATE' -------------DATEADD(DEATEPART, (+/- YEAR OR DATE OR MONTH) , GETDATE() 
	ELSE  CAST(TRY_CAST(DATEVALUE AS DATE) AS varchar)
	END AS NEW_DATEVALUE,
	FORMAT(GETDATE() , 'MM/dd/yyyy') AS NEW_FOMRAT_STAGE,
	FORMAT (GETDATE() , 'dd-MMM-yyyy') AS NEW_FORMAT_STAGE,
	CONVERT (VARCHAR, GETDATE(),120) AS S120_FORMAT,
	CASE
	WHEN TimeValue IS NULL OR LTRIM(RTRIM(TimeValue)) = ''THEN 'NOT GOOD'
	WHEN CAST(TimeValue AS TIME) IS NULL THEN 'NOT TIME VALUE'
	WHEN CAST(TIMEVALUE AS TIME) NOT BETWEEN '00:00:00' AND '23:59:59' THEN 'INVALID'
	ELSE CAST(TIMEVALUE AS TIME(0))
	END AS NEW_TIME,
	CASE
	WHEN DateTime2Value IS NULL OR LTRIM(RTRIM(DateTime2Value)) = '' THEN 'INVALID FORMAT'
	ELSE CAST(DateTime2Value AS DATETIME2(0)) 
	END AS DATETIME2VALUE
FROM datetime_validation_50000_rows 
