CREATE DATABASE MNC_TESTING_FINAL;
USE MNC_TESTING_FINAL;

SELECT * FROM datetime_validation_50000_rows;

SELECT GETDATE();


SELECT * FROM 
(SELECT DATEVALUE,
CASE
WHEN DATEVALUE IS NULL OR LTRIM(RTRIM(DATEVALUE)) = '' THEN 'DATEFORMAT IS NOT GOOD'
WHEN  TRY_CAST(DATEVALUE AS DATE) IS NULL THEN 'THIS IS NOT DATE FORMAT'
WHEN  TRY_CAST(DATEVALUE AS DATE) > GETDATE() THEN 'WORNG'
WHEN  TRY_CAST(DATEVALUE AS DATE) < DATEADD (YEAR,-5,GETDATE()) THEN 'OLDDATE' -------------DATEADD(DEATEPART, (+/- YEAR OR DATE OR MONTH) , GETDATE() 
ELSE  CAST(TRY_CAST(DATEVALUE AS DATE) AS varchar)
END AS NEW_DATEVALUE
FROM datetime_validation_50000_rows ) AS DATE_FORMAT_DATA
WHERE NEW_DATEVALUE = 'WORNG'


SELECT  DATEVALUE,DATEADD(DAY, -2, GETDATE()) AS LESS_DATE
FROM datetime_validation_50000_rows

SELECT DATEVALUE , FORMAT(GETDATE() ,'yyyy-mm-dd') AS NEWFORMAT , 
FORMAT(GETDATE() , 'dd-mm-yyyy') AS NEW_FORMAT,
FORMAT(GETDATE() , 'MM/dd/yyyy') AS NEW_FOMRAT_STAGE,
FORMAT (GETDATE() , 'dd-MMM-yyyy') AS NEW_FORMAT_STAGE
FROM datetime_validation_50000_rows
------------THIS IS USED FOR CONVERSION METHOD-------------------------------------------------
SELECT DATEVALUE,
CONVERT (VARCHAR, GETDATE(),101) AS S101_FORMAT,
CONVERT (VARCHAR, GETDATE(),103) AS S102_FORMAT,
CONVERT (VARCHAR, GETDATE(),104) AS S104_FORMAT,
CONVERT (VARCHAR, GETDATE(),105) AS S105_FORMAT,
CONVERT (VARCHAR, GETDATE(),112) AS S112_FORMAT,
CONVERT (VARCHAR, GETDATE(),120) AS S120_FORMAT,
CONVERT (VARCHAR, GETDATE(),121) AS S121_FORMAT
FROM datetime_validation_50000_rows
--------------------------------------THIS IS FOR TIME BUT SOME PROBLE FACING ---------------------------
SELECT 
CASE
WHEN TimeValue IS NULL OR LTRIM(RTRIM(TimeValue)) = ''THEN 'NOT GOOD'
WHEN CAST(TimeValue AS TIME) IS NULL THEN 'NOT TIME VALUE'
WHEN CAST(TIMEVALUE AS TIME) NOT BETWEEN '00:00:00' AND '23:59:59' THEN 'INVALID'
	 ELSE CAST(TIMEVALUE AS TIME(0))
	 END AS NEW_TIME
FROM datetime_validation_50000_rows

SELECT
CASE
WHEN DateTimeValue IS NULL OR LTRIM(RTRIM(DateTimeValue)) = '' THEN 'INVALID FORMAT'
WHEN CAST(DateTimeValue AS DATETIME2) IS NULL THEN 'THIS IS NOT DATETIME2'
WHEN CAST(DateTimeValue AS time) NOT BETWEEN '00:00:00' AND '23:59:59' THEN 'TIMEFORMAT IS NOT GOOD'
ELSE CAST(DateTimeValue AS DATETIME2(0)) 
END AS NEW_DATETIMEVALUE
FROM datetime_validation_50000_rows

SELECT CASE
WHEN DateTime2Value IS NULL OR LTRIM(RTRIM(DateTime2Value)) = '' THEN 'INVALID FORMAT'
ELSE CAST(DateTime2Value AS DATETIME2(0)) 
END AS DateTime2Value
FROM datetime_validation_50000_rows

----------------------------------------SILVER TABLE INSET DATA--------------------------
SELECT 
	CASE
	WHEN DATEVALUE IS NULL OR LTRIM(RTRIM(DATEVALUE)) = '' THEN 'DATEFORMAT IS NOT GOOD'
	WHEN  TRY_CAST(DATEVALUE AS DATE) IS NULL THEN 'THIS IS NOT DATE FORMAT'
	WHEN  TRY_CAST(DATEVALUE AS DATE) > GETDATE() THEN 'WORNG'
	WHEN  TRY_CAST(DATEVALUE AS DATE) < DATEADD (YEAR,-5,GETDATE()) THEN 'OLDDATE' -------------DATEADD(DEATEPART, (+/- YEAR OR DATE OR MONTH) , GETDATE() 
	ELSE  CAST(TRY_CAST(DATEVALUE AS DATE) AS varchar)
	END AS NEW_DATEVALUE,
	FORMAT(GETDATE() , 'MM/dd/yyyy') AS NEW_FOMRAT_STAGE,
	FORMAT (GETDATE() , 'dd-MMM-yyyy') AS NEW_FORMAT_STAGE,
	CONVERT (VARCHAR, GETDATE(),120) AS S120_FORMAT,
	CASE
	WHEN TimeValue IS NULL OR LTRIM(RTRIM(TimeValue)) = ''THEN 'NOT GOOD'
	WHEN CAST(TimeValue AS TIME) IS NULL THEN 'NOT TIME VALUE'
	WHEN CAST(TIMEVALUE AS TIME) NOT BETWEEN '00:00:00' AND '23:59:59' THEN 'INVALID'
	ELSE CAST(TIMEVALUE AS TIME(0))
	END AS NEW_TIME,
	CASE
	WHEN DateTime2Value IS NULL OR LTRIM(RTRIM(DateTime2Value)) = '' THEN 'INVALID FORMAT'
	ELSE CAST(DateTime2Value AS DATETIME2(0)) 
	END AS DATETIME2VALUE
FROM datetime_validation_50000_rows
